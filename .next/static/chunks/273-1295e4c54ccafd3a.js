"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[273],{8273:function(e,t,s){s.d(t,{$:function(){return L}});var i=s(681),o=s(5852),n=s(7549),r=s(1590),l=s(9006),a=s(687),d=s(4e3),c=s(6731),p=s(4056),m=s(171),x=s(1074),u=s(4420),h=s(7715),g=s(5331),f=s(9165),y=s(221),v=s(9001),w=s(9317),b=s(6310),j=s(4893),N=s(8025);let S=e=>{let{device:t,position:s,isVisible:n,onClose:r,onAction:l}=e,a=(0,o.useRef)(null);if((0,o.useEffect)(()=>{let e=e=>{a.current&&!a.current.contains(e.target)&&r()},t=e=>{"Escape"===e.key&&r()};return n&&(document.addEventListener("mousedown",e),document.addEventListener("keydown",t)),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("keydown",t)}},[n,r]),!n)return null;let d=[{icon:y.Z,label:"Пинг устройства",action:"ping",color:"text-green-400 hover:text-green-300",disabled:"offline"===t.status},{icon:v.Z,label:"SSH подключение",action:"ssh",color:"text-blue-400 hover:text-blue-300",disabled:"offline"===t.status},{icon:w.Z,label:"Веб-интерфейс",action:"web",color:"text-purple-400 hover:text-purple-300",disabled:"offline"===t.status},{divider:!0},{icon:h.Z,label:"Настройки",action:"settings",color:"text-slate-400 hover:text-white"},{icon:b.Z,label:"Редактировать",action:"edit",color:"text-slate-400 hover:text-white"},{icon:p.Z,label:"Сканировать порты",action:"scan",color:"text-cyan-400 hover:text-cyan-300"},{divider:!0},{icon:j.Z,label:"Просмотр логов",action:"logs",color:"text-yellow-400 hover:text-yellow-300"},{icon:x.Z,label:"Безопасность",action:"security",color:"text-orange-400 hover:text-orange-300"},{divider:!0},{icon:N.Z,label:"Удалить устройство",action:"delete",color:"text-red-400 hover:text-red-300",dangerous:!0}],c={x:Math.min(s.x,window.innerWidth-250),y:Math.min(s.y,window.innerHeight-40*d.length)};return(0,i.jsxs)("div",{ref:a,className:"fixed z-50 min-w-[240px] rounded-lg border border-slate-600/50 bg-slate-800/95 py-2 shadow-xl backdrop-blur-sm",style:{left:c.x,top:c.y},children:[(0,i.jsx)("div",{className:"border-b border-slate-600/50 px-4 py-2",children:(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"h-3 w-3 rounded-full ".concat("online"===t.status?"bg-green-500":"warning"===t.status?"bg-yellow-500":"bg-red-500")}),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"text-sm font-medium text-white",children:t.name}),(0,i.jsx)("div",{className:"text-xs text-slate-400",children:t.ip})]})]})}),(0,i.jsx)("div",{className:"py-1",children:d.map((e,s)=>{if("divider"in e)return(0,i.jsx)("div",{className:"mx-2 my-1 h-px bg-slate-600/30"},s);let o=e.icon;return(0,i.jsxs)("button",{onClick:()=>{l(e.action,t),r()},disabled:e.disabled,className:"flex w-full items-center space-x-3 px-4 py-2 text-sm transition-colors ".concat(e.disabled?"cursor-not-allowed text-slate-500":"".concat(e.color," cursor-pointer hover:bg-slate-700/50")," ").concat(e.dangerous?"hover:bg-red-500/10":""),children:[(0,i.jsx)(o,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:e.label}),e.disabled&&(0,i.jsx)("span",{className:"ml-auto text-xs text-slate-500",children:"(офлайн)"})]},s)})}),(0,i.jsxs)("div",{className:"border-t border-slate-600/50 px-4 py-2 text-xs text-slate-400",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsxs)("span",{children:["Тип: ",t.type]}),(0,i.jsxs)("span",{children:["Время отклика: ",t.responseTime,"ms"]})]}),(0,i.jsxs)("div",{className:"mt-1 flex justify-between",children:[(0,i.jsxs)("span",{children:["Uptime: ",t.uptime.toFixed(1),"%"]}),(0,i.jsxs)("span",{children:["Последний: ",new Date(t.lastSeen).toLocaleTimeString()]})]})]})]})};var D=s(7976),k=s(4788),I=s(2279),C=s(3673),B=s(5800);let F=e=>{let{toast:t,onClose:s}=e;return(0,o.useEffect)(()=>{let e=setTimeout(()=>{s(t.id)},t.duration||5e3);return()=>clearTimeout(e)},[t.id,t.duration,s]),(0,i.jsx)(n.E.div,{initial:{opacity:0,y:50,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-50,scale:.95},transition:{duration:.2},className:"border border-slate-600/50 bg-slate-800/95 backdrop-blur-sm ".concat((()=>{switch(t.type){case"success":return"border-l-green-500";case"error":return"border-l-red-500";case"warning":return"border-l-yellow-500";default:return"border-l-blue-500"}})()," w-full max-w-sm rounded-lg border-l-4 p-4 shadow-xl"),children:(0,i.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,i.jsx)("div",{className:"flex-shrink-0",children:(()=>{switch(t.type){case"success":return(0,i.jsx)(k.Z,{className:"h-5 w-5 text-green-400"});case"error":return(0,i.jsx)(j.Z,{className:"h-5 w-5 text-red-400"});case"warning":return(0,i.jsx)(I.Z,{className:"h-5 w-5 text-yellow-400"});default:return(0,i.jsx)(C.Z,{className:"h-5 w-5 text-blue-400"})}})()}),(0,i.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,i.jsx)("h4",{className:"text-sm font-medium text-white",children:t.title}),t.message&&(0,i.jsx)("p",{className:"mt-1 text-sm text-slate-300",children:t.message})]}),(0,i.jsx)("button",{onClick:()=>s(t.id),className:"flex-shrink-0 text-slate-400 transition-colors hover:text-white",children:(0,i.jsx)(B.Z,{className:"h-4 w-4"})})]})})},Z=e=>{let{toasts:t,onClose:s}=e;return(0,i.jsx)("div",{className:"fixed right-4 top-4 z-[100] space-y-2",children:(0,i.jsx)(D.M,{children:t.map(e=>(0,i.jsx)(F,{toast:e,onClose:s},e.id))})})},E=()=>{let[e,t]=(0,o.useState)([]),s=e=>{let s=Date.now().toString();t(t=>[...t,{...e,id:s}])};return{toasts:e,addToast:s,removeToast:e=>{t(t=>t.filter(t=>t.id!==e))},success:(e,t,i)=>{s({type:"success",title:e,message:t,duration:i})},error:(e,t,i)=>{s({type:"error",title:e,message:t,duration:i})},warning:(e,t,i)=>{s({type:"warning",title:e,message:t,duration:i})},info:(e,t,i)=>{s({type:"info",title:e,message:t,duration:i})}}},T={router:r.Z,switch:l.Z,computer:a.Z,server:d.Z,mobile:c.Z,wifi:p.Z,workstation:a.Z,printer:m.Z,firewall:x.Z,access_point:p.Z},M={router:"#3B82F6",switch:"#10B981",computer:"#8B5CF6",server:"#F59E0B",mobile:"#EF4444",wifi:"#06B6D4",workstation:"#6B7280",printer:"#F97316",firewall:"#DC2626",access_point:"#10B981"};function L(e){let{isFullscreen:t=!1}=e,{devices:s,updateDevice:r,selectedFolderId:d}=(0,f.v)(),{toasts:c,removeToast:p,success:m,error:x,warning:y,info:v}=E(),[w,b]=(0,o.useState)(!1),[j,N]=(0,o.useState)([]),[D,k]=(0,o.useState)({isDragging:!1,deviceId:null,offset:{x:0,y:0}}),[I,C]=(0,o.useState)({isConnecting:!1,sourceId:null,tempLine:null}),[B,F]=(0,o.useState)({isVisible:!1,device:null,position:{x:0,y:0}}),[L,A]=(0,o.useState)({}),H=(0,o.useRef)(null),U=(0,o.useCallback)(e=>{let t={};return e.forEach((e,s)=>{t[e.id]={x:100+s%4*200,y:80+150*Math.floor(s/4)}}),t},[]);(0,o.useEffect)(()=>{let e=localStorage.getItem("topology-positions");if(e)try{let t=JSON.parse(e);A(t)}catch(e){console.error("Failed to load positions:",e)}else A(U(s));let t=localStorage.getItem("topology-connections");if(t)try{let e=JSON.parse(t);N(e)}catch(e){console.error("Failed to load connections:",e)}},[s,U]),(0,o.useEffect)(()=>{Object.keys(L).length>0&&localStorage.setItem("topology-positions",JSON.stringify(L))},[L]),(0,o.useEffect)(()=>{localStorage.setItem("topology-connections",JSON.stringify(j))},[j]);let O=s.map(e=>({...e,position:L[e.id]||{x:100,y:100}})),P=(e,t)=>{var s;if(!w)return;e.preventDefault();let i=null===(s=H.current)||void 0===s?void 0:s.getBoundingClientRect();if(!i)return;let o=O.find(e=>e.id===t);(null==o?void 0:o.position)&&k({isDragging:!0,deviceId:t,offset:{x:e.clientX-i.left-o.position.x,y:e.clientY-i.top-o.position.y}})},R=()=>{k({isDragging:!1,deviceId:null,offset:{x:0,y:0}})},W=e=>{if(w){if(I.isConnecting){if(I.sourceId===e)C({isConnecting:!1,sourceId:null,tempLine:null}),v("Отменено","Создание соединения отменено");else{let t={id:"".concat(I.sourceId,"-").concat(e),sourceId:I.sourceId,targetId:e};N(e=>[...e,t]),C({isConnecting:!1,sourceId:null,tempLine:null}),m("Соединение создано","Новое соединение успешно добавлено")}}else{let t=O.find(t=>t.id===e);(null==t?void 0:t.position)&&(C({isConnecting:!0,sourceId:e,tempLine:{x1:t.position.x,y1:t.position.y,x2:t.position.x,y2:t.position.y}}),v("Режим соединения","Кликните на другое устройство для создания соединения"))}}},_=e=>{N(t=>t.filter(t=>t.id!==e)),y("Соединение удалено","Соединение между устройствами удалено")},J=(e,t)=>{e.preventDefault(),F({isVisible:!0,device:t,position:{x:e.clientX,y:e.clientY}})},X=()=>{F({isVisible:!1,device:null,position:{x:0,y:0}})};return(0,i.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"rounded-xl border border-slate-700/50 bg-slate-800/50 p-6 backdrop-blur-sm",children:[!t&&(0,i.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:"rounded-lg bg-slate-700/50 p-2",children:(0,i.jsx)(l.Z,{className:"h-5 w-5 text-blue-400"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Сетевая топология"}),(0,i.jsx)("p",{className:"text-sm text-slate-400",children:"Интерактивная карта сети"})]})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("button",{onClick:()=>b(!w),className:"rounded-lg px-4 py-2 transition-colors ".concat(w?"border border-green-500/30 bg-green-500/20 text-green-400":"bg-slate-700/50 text-slate-400 hover:bg-slate-700 hover:text-white"),children:w?"Выйти из редактора":"Режим редактирования"}),w&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("button",{onClick:()=>{A(U(s)),N([]),localStorage.removeItem("topology-positions"),localStorage.removeItem("topology-connections"),m("Макет сброшен","Расположение устройств и соединения сброшены к настройкам по умолчанию")},className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-700/50 hover:text-white",title:"Сбросить расположение",children:(0,i.jsx)(u.Z,{className:"h-4 w-4"})}),(0,i.jsx)("button",{onClick:()=>{localStorage.getItem("topology-positions"),localStorage.getItem("topology-connections")},className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-700/50 hover:text-white",title:"Отладка localStorage",children:"\uD83D\uDC1B"})]}),(0,i.jsx)("button",{className:"rounded-lg p-2 text-slate-400 transition-colors hover:bg-slate-700/50 hover:text-white",children:(0,i.jsx)(h.Z,{className:"h-4 w-4"})}),(0,i.jsxs)("button",{onClick:()=>window.open("/topology-fullscreen","_blank"),className:"flex items-center space-x-2 rounded-lg border border-blue-500/30 bg-blue-500/20 px-4 py-2 text-blue-400 transition-colors hover:bg-blue-500/30",title:"Открыть в полноэкранном режиме",children:[(0,i.jsx)(g.Z,{className:"h-4 w-4"}),(0,i.jsx)("span",{children:"Полный экран"})]})]})]}),w&&(0,i.jsx)("div",{className:"mb-4 rounded-lg border border-blue-500/20 bg-blue-500/10 p-3",children:(0,i.jsxs)("p",{className:"text-sm text-blue-400",children:[(0,i.jsx)("strong",{children:"Режим редактирования:"})," Перетаскивайте устройства для их перемещения. Кликайте по устройствам для создания соединений.",I.isConnecting&&(0,i.jsx)("span",{className:"ml-2 text-yellow-400",children:"Кликните на другое устройство для подключения, или на то же для отмены."})]})}),(0,i.jsx)("div",{className:"relative w-full rounded-lg border border-slate-700/30 bg-slate-900/50",style:{height:t?"calc(100vh - 120px)":"700px"},children:(0,i.jsxs)("svg",{ref:H,width:"100%",height:"100%",className:"overflow-visible",onMouseMove:e=>{var t;if(!w)return;let s=null===(t=H.current)||void 0===t?void 0:t.getBoundingClientRect();if(s){if(D.isDragging&&D.deviceId){let t=e.clientX-s.left-D.offset.x,i=e.clientY-s.top-D.offset.y;A(e=>({...e,[D.deviceId]:{x:t,y:i}}))}I.isConnecting&&I.sourceId&&C(t=>({...t,tempLine:{...t.tempLine,x2:e.clientX-s.left,y2:e.clientY-s.top}}))}},onMouseUp:R,onMouseLeave:R,children:[(0,i.jsx)("defs",{children:(0,i.jsx)("pattern",{id:"topology-grid",width:"20",height:"20",patternUnits:"userSpaceOnUse",children:(0,i.jsx)("path",{d:"M 20 0 L 0 0 0 20",fill:"none",stroke:"#475569",strokeWidth:"0.5",opacity:"0.3"})})}),(0,i.jsx)("rect",{width:"100%",height:"100%",fill:"url(#topology-grid)"}),j.map(e=>{let t=O.find(t=>t.id===e.sourceId),s=O.find(t=>t.id===e.targetId);return t&&s?(0,i.jsxs)("g",{children:[(0,i.jsx)("line",{x1:t.position.x,y1:t.position.y,x2:s.position.x,y2:s.position.y,stroke:"#6B7280",strokeWidth:"2",strokeDasharray:"5,5"}),w&&(0,i.jsx)("circle",{cx:(t.position.x+s.position.x)/2,cy:(t.position.y+s.position.y)/2,r:"8",fill:"#EF4444",className:"cursor-pointer hover:fill-red-600",onClick:()=>_(e.id),children:(0,i.jsx)("title",{children:"Кликните для удаления соединения"})})]},e.id):null}),I.tempLine&&(0,i.jsx)("line",{x1:I.tempLine.x1,y1:I.tempLine.y1,x2:I.tempLine.x2,y2:I.tempLine.y2,stroke:"#3B82F6",strokeWidth:"2",strokeDasharray:"3,3",opacity:"0.7"}),O.map(e=>{let t=T[e.type]||a.Z,s=M[e.type]||"#6B7280",o=I.sourceId===e.id,n=!d||"root"===d||e.folderId===d;return(0,i.jsxs)("g",{transform:"translate(".concat(e.position.x,", ").concat(e.position.y,")"),className:"cursor-pointer",style:{opacity:n?1:.3},onMouseDown:t=>P(t,e.id),onClick:()=>W(e.id),onContextMenu:t=>J(t,e),children:[(0,i.jsx)("circle",{r:o?"28":"25",fill:"online"===e.status?s:"#6B7280",opacity:"0.2",stroke:o?"#3B82F6":"transparent",strokeWidth:"2"}),(0,i.jsx)("circle",{r:"20",fill:"online"===e.status?s:"#6B7280",opacity:"0.3"}),(0,i.jsx)("foreignObject",{x:"-12",y:"-12",width:"24",height:"24",children:(0,i.jsx)(t,{className:"h-6 w-6 text-white"})}),(0,i.jsx)("text",{x:"0",y:"40",textAnchor:"middle",className:"fill-white text-xs font-medium",children:e.name}),(0,i.jsx)("circle",{cx:"15",cy:"-15",r:"4",fill:"online"===e.status?"#10B981":"warning"===e.status?"#F59E0B":"#EF4444"}),w&&(0,i.jsx)("circle",{r:"25",fill:"transparent",stroke:"#3B82F6",strokeWidth:"1",strokeDasharray:"2,2",opacity:"0.5"})]},e.id)})]})}),(0,i.jsxs)("div",{className:"mt-4 flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("div",{className:"h-3 w-3 rounded-full bg-green-500 opacity-60"}),(0,i.jsx)("span",{className:"text-slate-400",children:"Онлайн"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("div",{className:"h-3 w-3 rounded-full bg-yellow-500 opacity-60"}),(0,i.jsx)("span",{className:"text-slate-400",children:"Предупреждение"})]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)("div",{className:"h-3 w-3 rounded-full bg-red-500 opacity-60"}),(0,i.jsx)("span",{className:"text-slate-400",children:"Офлайн"})]})]}),(0,i.jsxs)("div",{className:"text-sm text-slate-500",children:[O.length," устройств • ",j.length," ","соединений"]})]}),(0,i.jsx)(S,{device:B.device,position:B.position,isVisible:B.isVisible,onClose:X,onAction:(e,t)=>{switch(X(),e){case"ping":"online"===t.status?m("Ping успешен","Устройство ".concat(t.name," отвечает")):x("Ping неудачен","Устройство ".concat(t.name," не отвечает"));break;case"ssh":"online"===t.status?v("SSH соединение","Подключение к ".concat(t.name," через SSH...")):x("SSH недоступен","Устройство ".concat(t.name," офлайн"));break;case"web":"online"===t.status?v("Веб-интерфейс","Открытие веб-интерфейса ".concat(t.name,"...")):x("Веб-интерфейс недоступен","Устройство ".concat(t.name," офлайн"));break;case"edit":v("Редактирование","Редактирование настроек ".concat(t.name,"..."));break;case"delete":y("Удаление устройства","Устройство ".concat(t.name," помечено для удаления"));break;default:v(e,'Действие "'.concat(e,'" для устройства ').concat(t.name))}}}),(0,i.jsx)(Z,{toasts:c,onClose:p})]})}},9165:function(e,t,s){s.d(t,{v:function(){return m}});var i=s(7526),o=s(3872);let n=[{id:"datacenter",name:"Центр обработки данных",description:"Серверы и сетевое оборудование ЦОД",parentId:"root",color:"#3B82F6",icon:"Building",expanded:!0,children:[{id:"servers",name:"Серверы",description:"Физические и виртуальные серверы",parentId:"datacenter",color:"#10B981",icon:"Server",expanded:!1,children:[]},{id:"storage",name:"Системы хранения",description:"NAS и SAN системы",parentId:"datacenter",color:"#8B5CF6",icon:"Database",expanded:!1,children:[]}]},{id:"core",name:"Ядро сети",description:"Основное сетевое оборудование",parentId:"root",color:"#EF4444",icon:"Network",expanded:!1,children:[]},{id:"access",name:"Уровень доступа",description:"Коммутаторы доступа и точки WiFi",parentId:"root",color:"#F59E0B",icon:"Globe",expanded:!1,children:[]},{id:"security",name:"Безопасность",description:"Системы безопасности и мониторинга",parentId:"root",color:"#DC2626",icon:"Shield",expanded:!1,children:[]}],r=[{id:"server-web-1",name:"Веб сервер 1",ip:"192.168.1.10",mac:"00:1B:44:11:3A:B7",type:"server",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:8,uptime:99.2,location:"Стойка A-1",folderId:"servers",vendor:"Dell",model:"PowerEdge R740",monitoring:{ping:!0,snmp:!0,http:!0,ssh:!0},position:{x:100,y:200}},{id:"server-db-1",name:"База данных",ip:"192.168.1.11",mac:"00:1B:44:11:3A:B8",type:"server",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:5,uptime:99.8,location:"Стойка A-2",folderId:"servers",vendor:"HP",model:"ProLiant DL380",monitoring:{ping:!0,snmp:!0,http:!1,ssh:!0},position:{x:150,y:200}},{id:"switch-core-1",name:"Основной коммутатор",ip:"192.168.1.1",mac:"00:1B:44:11:01:01",type:"switch",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:2,uptime:99.9,location:"Стойка Core-1",folderId:"core",vendor:"Cisco",model:"Catalyst 9300",monitoring:{ping:!0,snmp:!0,http:!0,ssh:!0},position:{x:300,y:150}},{id:"router-main",name:"Основной маршрутизатор",ip:"192.168.1.254",mac:"00:1B:44:11:02:01",type:"router",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:3,uptime:99.7,location:"Стойка Core-1",folderId:"core",vendor:"Cisco",model:"ISR 4351",monitoring:{ping:!0,snmp:!0,http:!0,ssh:!0},position:{x:350,y:100}},{id:"switch-office-1",name:"Офисный коммутатор 1",ip:"192.168.1.51",mac:"00:1B:44:11:05:01",type:"switch",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:6,uptime:98.5,location:"1 этаж офис",folderId:"access",vendor:"Cisco",model:"Catalyst 2960X",monitoring:{ping:!0,snmp:!0,http:!1,ssh:!0},position:{x:200,y:300}},{id:"switch-office-2",name:"Офисный коммутатор 2",ip:"192.168.1.52",mac:"00:1B:44:11:05:02",type:"switch",status:"offline",lastSeen:new Date("2024-01-15T08:15:00Z"),responseTime:0,uptime:97.2,location:"2 этаж офис",folderId:"access",vendor:"Cisco",model:"Catalyst 2960X",monitoring:{ping:!0,snmp:!0,http:!1,ssh:!0},position:{x:250,y:400}},{id:"ap-floor1-01",name:"WiFi точка доступа 1 этаж восток",ip:"192.168.1.161",mac:"00:1B:44:16:01:01",type:"access_point",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:5,uptime:99.1,location:"1 этаж - Восточное крыло",folderId:"access",vendor:"Ubiquiti",model:"UniFi AP AC Pro",monitoring:{ping:!0,snmp:!0,http:!0,ssh:!0},position:{x:400,y:350}},{id:"firewall-main",name:"Межсетевой экран",ip:"192.168.1.2",mac:"00:1B:44:11:02:02",type:"firewall",status:"online",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:4,uptime:99.6,location:"Стойка Security-1",folderId:"security",vendor:"Fortinet",model:"FortiGate 100F",monitoring:{ping:!0,snmp:!0,http:!0,ssh:!0},position:{x:500,y:100}},{id:"nas-backup",name:"Система резервного копирования",ip:"192.168.1.20",mac:"00:1B:44:11:20:01",type:"server",status:"warning",lastSeen:new Date("2024-01-15T10:30:00Z"),responseTime:15,uptime:96.8,location:"Стойка Storage-1",folderId:"storage",vendor:"Synology",model:"DS920+",monitoring:{ping:!0,snmp:!0,http:!0,ssh:!1},position:{x:550,y:200}}],l=[{id:"alert-1",type:"warning",message:"Высокая загрузка CPU на сервере web-1",timestamp:new Date(Date.now()-3e5),deviceId:"server-web-1",resolved:!1},{id:"alert-2",type:"info",message:"Обновление ПО завершено успешно",timestamp:new Date(Date.now()-6e5),resolved:!0},{id:"alert-3",type:"critical",message:"Потеря связи с устройством switch-office-2",timestamp:new Date(Date.now()-9e5),resolved:!1}],a={totalDevices:10,onlineDevices:8,offlineDevices:1,warningDevices:1,averageResponseTime:6,totalBandwidth:1e3,usedBandwidth:720,packetLoss:.2,networkUptime:98.7,lastUpdate:new Date},d={cpu:65,memory:78,disk:45,network:23,temperature:42,processes:156,uptime:2847392,lastUpdate:new Date},c=Array.from({length:20},(e,t)=>({timestamp:new Date(Date.now()-(19-t)*3e5),upload:Math.floor(300*Math.random())+50,download:Math.floor(800*Math.random())+100,total:0})).map(e=>({...e,total:e.upload+e.download})),p={pingInterval:5e3,snmpInterval:3e4,httpTimeout:1e4,retryAttempts:3,alertThresholds:{responseTime:100,packetLoss:5,cpuUsage:80,memoryUsage:85,diskUsage:90}},m=(0,i.Ue)()((0,o.XR)((0,o.tJ)((e,t)=>({devices:r,folders:n,metrics:a,bandwidthHistory:c,alerts:l,systemHealth:d,connections:[],config:p,selectedFolderId:"root",sidebarCollapsed:!1,loading:!1,error:null,rootFolderExpanded:!0,othersExpanded:!1,addDevice:s=>{let i={...s,id:Math.random().toString(36).substr(2,9),lastSeen:new Date,status:"online"};e(e=>({devices:[...e.devices,i]})),t().updateMetrics({})},updateDevice:(s,i)=>{e(e=>({devices:e.devices.map(e=>e.id===s?{...e,...i,lastSeen:new Date}:e)})),t().updateMetrics({})},deleteDevice:s=>{e(e=>({devices:e.devices.filter(e=>e.id!==s)})),t().updateMetrics({})},addFolder:t=>{let s={...t,id:Math.random().toString(36).substr(2,9),children:[]},i=e=>e.map(e=>e.id===(s.parentId||"root")?{...e,children:[...e.children,s]}:{...e,children:i(e.children)});s.parentId&&"root"!==s.parentId?e(e=>({folders:i(e.folders)})):e(e=>({folders:[...e.folders,s]}))},updateFolder:(t,s)=>{if("root"===t){e(e=>({rootFolderExpanded:void 0!==s.expanded?s.expanded:e.rootFolderExpanded}));return}if("others"===t){e(e=>({othersExpanded:void 0!==s.expanded?s.expanded:e.othersExpanded}));return}let i=e=>e.map(e=>e.id===t?{...e,...s}:{...e,children:i(e.children)});e(e=>({folders:i(e.folders)}))},deleteFolder:t=>{let s=e=>e.filter(e=>e.id!==t).map(e=>({...e,children:s(e.children)}));e(e=>({folders:s(e.folders),devices:e.devices.map(e=>e.folderId===t?{...e,folderId:"root"}:e)}))},addAlert:t=>{let s={...t,id:Math.random().toString(36).substr(2,9),timestamp:new Date};e(e=>({alerts:[s,...e.alerts].slice(0,50)}))},markAlertResolved:t=>{e(e=>({alerts:e.alerts.map(e=>e.id===t?{...e,resolved:!0}:e)}))},acknowledgeAlert:(t,s)=>{e(e=>({alerts:e.alerts.map(e=>e.id===t?{...e,acknowledgedBy:s,acknowledgedAt:new Date}:e)}))},clearAlerts:()=>{e({alerts:[]})},setBandwidthData:t=>{e({bandwidthHistory:t})},addBandwidthData:t=>{e(e=>({bandwidthHistory:[...e.bandwidthHistory.slice(-19),t]}))},updateSystemHealth:t=>{e({systemHealth:t})},updateMetrics:s=>{let i=t(),o=i.devices,n=o.length,r=o.filter(e=>"online"===e.status).length,l=o.filter(e=>"offline"===e.status).length,a=o.filter(e=>"warning"===e.status).length,d=n>0?Math.round(o.reduce((e,t)=>e+t.responseTime,0)/n):0;e({metrics:{...i.metrics,totalDevices:n,onlineDevices:r,offlineDevices:l,warningDevices:a,averageResponseTime:d,lastUpdate:new Date,...s}})},setSelectedFolder:t=>{e({selectedFolderId:t})},setSidebarCollapsed:t=>{e({sidebarCollapsed:t})},setLoading:t=>{e({loading:t})},setError:t=>{e({error:t})},refreshData:async()=>{e({loading:!0,error:null});try{await new Promise(e=>setTimeout(e,1e3)),t().updateMetrics({}),e({loading:!1})}catch(t){e({loading:!1,error:t instanceof Error?t.message:"Ошибка загрузки данных"})}},exportData:()=>{let e=t();return JSON.stringify({devices:e.devices,folders:e.folders,connections:e.connections,config:e.config,exportTimestamp:new Date().toISOString()},null,2)},importData:s=>{try{let i=JSON.parse(s);return e({devices:i.devices||[],folders:i.folders||[],connections:i.connections||[],config:i.config||p}),t().updateMetrics({}),!0}catch(e){return!1}},resetData:()=>{e({devices:[],folders:[],metrics:a,bandwidthHistory:[],alerts:[],systemHealth:d,connections:[],selectedFolderId:"root",loading:!1,error:null})},resetToMockData:()=>{e({devices:r,folders:n,metrics:a,bandwidthHistory:c,alerts:l,systemHealth:d,connections:[],selectedFolderId:"root",loading:!1,error:null,rootFolderExpanded:!0,othersExpanded:!1}),t().updateMetrics({})}}),{name:"network-monitor-storage",partialize:e=>({devices:e.devices,folders:e.folders,config:e.config,selectedFolderId:e.selectedFolderId,sidebarCollapsed:e.sidebarCollapsed})})))}}]);